-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into DBT_TEST.synapse_latest.int_nodes_filtered_to_latest as DBT_INTERNAL_DEST
        using DBT_TEST.synapse_latest.int_nodes_filtered_to_latest__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.node_id = DBT_INTERNAL_DEST.node_id))

    
    when matched then update set
        "CHANGE_TYPE" = DBT_INTERNAL_SOURCE."CHANGE_TYPE","CHANGE_USER_ID" = DBT_INTERNAL_SOURCE."CHANGE_USER_ID","NODE_ID" = DBT_INTERNAL_SOURCE."NODE_ID","BENEFACTOR_NODE_ID" = DBT_INTERNAL_SOURCE."BENEFACTOR_NODE_ID","PROJECT_NODE_ID" = DBT_INTERNAL_SOURCE."PROJECT_NODE_ID","PARENT_NODE_ID" = DBT_INTERNAL_SOURCE."PARENT_NODE_ID","NODE_TYPE" = DBT_INTERNAL_SOURCE."NODE_TYPE","CREATED_ON" = DBT_INTERNAL_SOURCE."CREATED_ON","CREATED_BY_USER_ID" = DBT_INTERNAL_SOURCE."CREATED_BY_USER_ID","MODIFIED_ON" = DBT_INTERNAL_SOURCE."MODIFIED_ON","MODIFIED_BY_USER_ID" = DBT_INTERNAL_SOURCE."MODIFIED_BY_USER_ID","VERSION_NUMBER" = DBT_INTERNAL_SOURCE."VERSION_NUMBER","FILE_HANDLE_ID" = DBT_INTERNAL_SOURCE."FILE_HANDLE_ID","NODE_NAME" = DBT_INTERNAL_SOURCE."NODE_NAME","IS_PUBLIC" = DBT_INTERNAL_SOURCE."IS_PUBLIC","IS_CONTROLLED_ACCESS" = DBT_INTERNAL_SOURCE."IS_CONTROLLED_ACCESS","IS_RESTRICTED_ACCESS" = DBT_INTERNAL_SOURCE."IS_RESTRICTED_ACCESS","EFFECTIVE_ACCESS_REQUIREMENTS" = DBT_INTERNAL_SOURCE."EFFECTIVE_ACCESS_REQUIREMENTS","ANNOTATIONS" = DBT_INTERNAL_SOURCE."ANNOTATIONS","DERIVED_ANNOTATIONS" = DBT_INTERNAL_SOURCE."DERIVED_ANNOTATIONS","VERSION_COMMENT" = DBT_INTERNAL_SOURCE."VERSION_COMMENT","VERSION_LABEL" = DBT_INTERNAL_SOURCE."VERSION_LABEL","ALIAS" = DBT_INTERNAL_SOURCE."ALIAS","ACTIVITY_ID" = DBT_INTERNAL_SOURCE."ACTIVITY_ID","COLUMN_MODEL_IDS" = DBT_INTERNAL_SOURCE."COLUMN_MODEL_IDS","SCOPE_IDS" = DBT_INTERNAL_SOURCE."SCOPE_IDS","ITEMS" = DBT_INTERNAL_SOURCE."ITEMS","REFERENCE" = DBT_INTERNAL_SOURCE."REFERENCE","IS_SEARCH_ENABLED" = DBT_INTERNAL_SOURCE."IS_SEARCH_ENABLED","DEFINING_SQL" = DBT_INTERNAL_SOURCE."DEFINING_SQL","INTERNAL_ANNOTATIONS" = DBT_INTERNAL_SOURCE."INTERNAL_ANNOTATIONS","VERSION_HISTORY" = DBT_INTERNAL_SOURCE."VERSION_HISTORY","PROJECT_STORAGE_USAGE" = DBT_INTERNAL_SOURCE."PROJECT_STORAGE_USAGE"
    

    when not matched then insert
        ("CHANGE_TYPE", "CHANGE_USER_ID", "NODE_ID", "BENEFACTOR_NODE_ID", "PROJECT_NODE_ID", "PARENT_NODE_ID", "NODE_TYPE", "CREATED_ON", "CREATED_BY_USER_ID", "MODIFIED_ON", "MODIFIED_BY_USER_ID", "VERSION_NUMBER", "FILE_HANDLE_ID", "NODE_NAME", "IS_PUBLIC", "IS_CONTROLLED_ACCESS", "IS_RESTRICTED_ACCESS", "EFFECTIVE_ACCESS_REQUIREMENTS", "ANNOTATIONS", "DERIVED_ANNOTATIONS", "VERSION_COMMENT", "VERSION_LABEL", "ALIAS", "ACTIVITY_ID", "COLUMN_MODEL_IDS", "SCOPE_IDS", "ITEMS", "REFERENCE", "IS_SEARCH_ENABLED", "DEFINING_SQL", "INTERNAL_ANNOTATIONS", "VERSION_HISTORY", "PROJECT_STORAGE_USAGE")
    values
        ("CHANGE_TYPE", "CHANGE_USER_ID", "NODE_ID", "BENEFACTOR_NODE_ID", "PROJECT_NODE_ID", "PARENT_NODE_ID", "NODE_TYPE", "CREATED_ON", "CREATED_BY_USER_ID", "MODIFIED_ON", "MODIFIED_BY_USER_ID", "VERSION_NUMBER", "FILE_HANDLE_ID", "NODE_NAME", "IS_PUBLIC", "IS_CONTROLLED_ACCESS", "IS_RESTRICTED_ACCESS", "EFFECTIVE_ACCESS_REQUIREMENTS", "ANNOTATIONS", "DERIVED_ANNOTATIONS", "VERSION_COMMENT", "VERSION_LABEL", "ALIAS", "ACTIVITY_ID", "COLUMN_MODEL_IDS", "SCOPE_IDS", "ITEMS", "REFERENCE", "IS_SEARCH_ENABLED", "DEFINING_SQL", "INTERNAL_ANNOTATIONS", "VERSION_HISTORY", "PROJECT_STORAGE_USAGE")

;
    commit;