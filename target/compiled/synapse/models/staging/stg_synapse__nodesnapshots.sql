

SELECT
    CHANGE_TYPE,
    CHANGE_TIMESTAMP,
    CHANGE_USER_ID,
    SNAPSHOT_TIMESTAMP,
    ID as node_id,
    BENEFACTOR_ID as benefactor_node_id,
    PROJECT_ID as project_node_id,
    PARENT_ID as parent_node_id,
    NODE_TYPE,
    CREATED_ON,
    CREATED_BY as created_by_user_id,
    MODIFIED_ON,
    MODIFIED_BY as modified_by_user_id,
    VERSION_NUMBER,
    FILE_HANDLE_ID,
    NAME AS node_name,
    IS_PUBLIC,
    IS_CONTROLLED AS is_controlled_access,
    IS_RESTRICTED AS is_restricted_access,
    SNAPSHOT_DATE,
    EFFECTIVE_ARS AS effective_access_requirements,
    ANNOTATIONS,
    DERIVED_ANNOTATIONS,
    VERSION_COMMENT,
    VERSION_LABEL,
    ALIAS,
    ACTIVITY_ID,
    COLUMN_MODEL_IDS,
    SCOPE_IDS,
    ITEMS,
    REFERENCE,
    IS_SEARCH_ENABLED,
    DEFINING_SQL,
    INTERNAL_ANNOTATIONS,
    VERSION_HISTORY,
    PROJECT_STORAGE_USAGE
FROM
    synapse_data_warehouse.synapse_raw.nodesnapshots